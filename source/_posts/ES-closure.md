---
title: 难懂的闭包
---

### 什么是闭包？

闭包是函数和声明该函数的词法环境的组合。这是 `MDN` 上对闭包给出的定义[传送门](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Closures)。

那闭包到底是什么？
**1. 变量作用域**

`ES` 的变量作用域无非就两种：全局作用域，局部作用域。
在 `ES` 中，函数内部可以读取全局作用域，而函数外部不能读取函数内部的变量。

**2. 实现在函数外部读取局部变量**

在 `ES` 特有的链式作用域中（简单可以理解为，后代可以获得祖先的东西）, 我们可以从一个函数返回另一个函数，并在外部调用这个函数，此时便可实现在函数外部读取局部变量。

在函数内部定义一个函数并返回该函数

```javascript
const fn1 = () => {
  const num = 26
  const fn2 = () => {
    console.log(num)
  }

  return fn2
}

fn1()()
```

**3. 用自己的话描述闭包**

上述代码其实便构成了闭包，先是调用了 `fn1` 返回了 `fn2`，再调用。fn2 其实就是那个闭包，它在外部调用并且读取了 `fn1` 的变量 `num`。

所以闭包就是能够读取其他函数内部变量的函数。也可以理解为是 j 将函数内部与函数外部连接起来的桥梁

### 闭包的应用

使用闭包可以做到什么？

- 使得一个变量长期驻扎在内存；
- 避免全局变量的污染；
- 创建私有成员

### 使用闭包引发的 `this` 指向问题？

### 浅解析闭包原理

忘记了是大神写的，抄过来的。-\_-  
当某个函数第一次被调用时，会创建一个执行环境（execution context)及相应的作用域链，并把作用域链赋值给一个特殊的内部属性（即[\[Scope]]）。然后，使用 this、arguncmts 和其他命名参数的值来初始化函数的活动对象（activation object)。但在作用域链中，外部函数的活动对象始终处于第二位，外部函数的外部函数的活动对象处于第三位，……直至作为作用域链终点的全局执行环境。
